var $jscomp={scope:{},findInternal:function(a,c,b){a instanceof String&&(a=String(a));for(var f=a.length,d=0;d<f;d++){var g=a[d];if(c.call(b,g,d,a))return{i:d,v:g}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){if(b.get||b.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,c,b,f){if(c){b=$jscomp.global;a=a.split(".");for(f=0;f<a.length-1;f++){var d=a[f];d in b||(b[d]={});b=b[d]}a=a[a.length-1];f=b[a];c=c(f);c!=f&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6-impl","es3");
var NewContext=function(a){var c=a.Language,b=!0,f=kingui,d=function(a){var b=null,e={Hide:function(){h.Hide()},Show:function(a,c,e){b=e;h.Show(a,c)}},h=f.NewMsg({Id:a,Btns:[{Name:c.Sure,Callback:function(){b?b.bind(e)():this.Hide()}},{Name:c.Cancel}]});return e},g=1,r=d(g++),l=d(g++),m=function(){var b=null,d=null;$("#idTagTree").hide().jstree({plugins:["conditionalselect","contextmenu","sort"],conditionalselect:function(){this.deselect_all(!0);return!0},contextmenu:{items:function(a){var e=this,
d={search:{label:c["search tag"],icon:"/public/img/book_16px.ico",action:function(){b&&b(e,a)}}};e.is_leaf(a)||(d.toggle={label:c["toggle tag"],icon:"/public/img/attachment_16px.ico",separator_before:!0,action:function(){e.toggle_node(a)}});return d}},sort:function(a,b){var c=this.get_node(a),e=this.get_node(b);return c.data.Sort>e.data.Sort?1:-1},core:{check_callback:!0,data:a.Data}}).on("ready.jstree",function(){$(this).show();d=$(this).jstree(!0)}).on("select_node.jstree",function(a,c){var e=$(this).jstree(!0),
d=c.node;!e.is_leaf(d)&&e.is_closed(d)&&e.open_node(d);0!=d.data.Docs&&b(e,d)}).off("keydown");return{Bind:function(a,c){"search"==a&&(b=c)},Tree:function(){return d}}}(),p=$("#idDocsView"),t=function(){return{Update:function(a,d,e){if(a){for(var f=[],h={},n=0;n<a.length;n++){var g=a[n],k=g.Id;h[k]=g;f.push("<p id='k-view-"+k+"'><span class='glyphicon glyphicon-wrench kBtnSpan' data-id='"+k+"'></span><span class='glyphicon glyphicon-remove kBtnSpan' data-id='"+k+"'></span><a target='_blank' href='/Document/Index?id="+
k+"'>"+g.Name+"</a></p>")}a=$(f.join(""));p.html(a);var m=function(a){b&&(b=!1,$.ajax({url:"/Document/AjaxRemove",type:"POST",dataType:"json",data:{id:a}}).done(function(b){0==b.Code?($("#k-view-"+a).remove(),b=d.Tree(),--e.data.Docs,b.set_text(e,e.data.Name+"&nbsp;&nbsp;&nbsp;&nbsp;["+e.data.Docs+"]")):l.Show(c["err.title"],b.Emsg)}).fail(function(){l.Show(c["err.title"],c["err net"])}).always(function(){b=!0}))};a.find(".glyphicon-wrench").click(function(a){a="/Document/Edit?id="+$(this).data("id");
window.open(a)});a.find(".glyphicon-remove").click(function(a){var b=$(this).data("id");r.Show(c["msg warning"],c.erase+" - "+h[b].Name+"<br>"+c["sure?"],function(){this.Hide();m(b)})})}else p.html(c["none data"])}}}(),q=null;m.Bind("search",function(a,d){b&&q!=d.id&&(b=!1,q=d.id,a.set_icon(d,"/public/img/throbber.gif"),$.ajax({url:"/Tag/AjaxGetDocs",type:"POST",dataType:"json",data:{tag:d.id}}).done(function(a){0==a.Code?t.Update(a.Data,m,d):l.Show(c["error title"],a.Emsg)}).fail(function(){l.Show(c["error title"],
c["err net"])}).always(function(){b=!0;a.set_icon(d)}))});var u=$("#idDocsHide");$("#kBtnIcon").click(function(a){p.toggle("fast");u.toggle("fast")})};
