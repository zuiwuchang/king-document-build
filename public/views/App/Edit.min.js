var $jscomp={scope:{},findInternal:function(b,a,g){b instanceof String&&(b=String(b));for(var p=b.length,c=0;c<p;c++){var l=b[c];if(a.call(g,l,c,b))return{i:c,v:l}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,g){if(g.get||g.set)throw new TypeError("ES3 does not support getters and setters.");b!=Array.prototype&&b!=Object.prototype&&(b[a]=g.value)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,a,g,p){if(a){g=$jscomp.global;b=b.split(".");for(p=0;p<b.length-1;p++){var c=b[p];c in g||(g[c]={});g=g[c]}b=b[b.length-1];p=g[b];a=a(p);a!=p&&null!=a&&$jscomp.defineProperty(g,b,{configurable:!0,writable:!0,value:a})}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6-impl","es3");
var NewContext=function(b){for(var a=b.Language,g=[{bar:"bar",tab:"\t"},{pre:"<pre class='k-pre'>XXXXXX</pre>","pre-l":"<pre class='k-pre'>","pre-r":"</pre>"},{strong:"<strong>XXXXXX</strong>","strong-l":"<strong>","strong-r":"</strong>"},{ol:"<ol>XXXXXX</ol>",ul:"<ul>XXXXXX</ul>",li:"<li>XXXXXX</li>"},{div:"<div>XXXXXX</div>",p:"<p>XXXXXX</p>",span:"<span>XXXXXX</span>",a:"<a href='XXXXXX' target='_blank'>XXXXXX</a>"}],p={},c=0;c<g.length;c++){var l=g[c],q;for(q in l)p[q]=l[q]}var M=function(){var a=
$("#idBtnSort"),b=$("#idModalSortBody");b.sortable().disableSelection();var e=$("#idModalSortSure"),c=$("#idModalSortCancel"),d=null,f=null;e.click(function(a){c.click();if(d){var h=[],e=!1;b.children("li").each(function(a,b){var d=$(b).data("id");h.push(d);e||d==f[a].Id||(e=!0)});e&&d(h)}});return{Show:function(h,e){f=h;d=e;for(var r="",x=0;x<h.length;x++)var c=h[x],r=r+("<li class='list-group-item' data-id='"+c.Id+"'>"+c.Name+"</li>");b.html(r);a.click()}}}(),J=function(){var a=$("#idBtnModalInput"),
b=$("#idModalInputTitle"),e=$("#idModalInputBody"),c=$("#idModalInputSure"),d=$("#idModalInputCancel"),f=null,g={Show:function(h,d,c){c&&(f=c);b.html(h);e.val(d);a.click();setTimeout(function(){e.select().focus()},200)},Hide:function(){d.click()}},k=function(){if(f){var a=e.val();f(g,a)}else d.click()};c.click(function(a){k()});e.keydown(function(a){13==a.keyCode&&k()});return g}(),N=function(){var a=$("#idBtnModalTextarea"),b=$("#idModalTextareaTitle"),e=$("#idModalTextareaBody"),c=$("#idModalTextareaSure"),
d=$("#idModalTextareaCancel"),f=null,g={Show:function(h,d,c){c&&(f=c);b.html(h);e.val(d);a.click();setTimeout(function(){e.select().focus()},200)},Hide:function(){d.click()},Reset:function(){e.val("")}};c.click(function(a){f?(a=e.val(),f(g,a)):d.click()});return g}(),k=function(){var a=$("#idBtnModalMsg"),b=$("#idModalMsgTitle"),e=$("#idModalMsgBody"),c=$("#idModalMsgSure"),d=$("#idModalMsgCancel"),f=null,g={Show:function(h,d,c){c&&(f=c);b.html(h);e.html(d);a.click()},Hide:function(){d.click()}};
c.click(function(a){f?f(g):d.click()});return g}(),O=kingui,c=1,E=function(b){var h=null,e={Hide:function(){c.Hide()},Show:function(a,b,e){h=e;c.Show(a,b)}},c=O.NewMsg({Id:b,Btns:[{Name:a.Sure,Callback:function(){h?h.bind(e)():this.Hide()}},{Name:a.Cancel}]});return e}(c++),I=function(a){var b=document.createElement("div");a=document.createTextNode(a);b.appendChild(a);return b.innerHTML},P=function(){var a=$("#idBtnModalHtml"),b=$("#idModalHtmlBtnCode"),e=$("#idModalHtmlBtnOk"),c=$("#idModalHtmlBody"),
d=$("#idModalHtmlVal");e.click(function(a){a=c.val();a=I(a);d.val(a)});b.click(function(a){a=c.val();a=I(a);d.val("<pre class='prettyprint linenums'>"+a+"</pre>")});return{Show:function(){c.val("");d.val("");a.click();setTimeout(function(){c.select().focus()},200)}}}(),Q=b.K,T=function(b,c){var e=0,h=$("#idPanelsView"),d=$("<div class='panel panel-default'><a name='panel-"+b+"'></a><div class='panel-heading'><span class='glyphicon glyphicon-asterisk kBtnSpan kBtnTop'></span><span class='glyphicon glyphicon-minus kBtnSpan kBtnMenuHide'></span><span class='glyphicon glyphicon-sort-by-attributes kBtnSpan kBtnMenuSort'></span><span class='kPanelName'>"+
c+"</span></div><div class='panel-body'><div class='kPanelHide' style='display: none;'>"+a["data is hide"]+"</div><div class='kPanelBody'><div class='kPanelBodyView'>"+a["wait init data"]+"</div><div class='kSectionNode'><span class='glyphicon glyphicon-plus kBtnSpan kBtnAddSection'></span></div></div></div></div>");h.append(d);var f=d.find(".kPanelName:first"),l=d.find(".kPanelHide:first"),x=d.find(".kPanelBody:first"),r=x.find(".kPanelBodyView:first"),t=d.find(".kBtnAddSection:first");t.hide();
var v=[],m=function(b,c,d){var h={Id:b,Name:c};v.push(h);var D="king-section-"+b,m=[];m.push("<div id='"+D+"'><h4 class='kSectionTitle'><span class='glyphicon glyphicon-minus kBtnSpan'></span><span class='glyphicon glyphicon-wrench kBtnSpan'></span><span class='glyphicon glyphicon-remove kBtnSpan'></span><span class='kTitleName'>"+c+"</span></h4><div class='kSectionHide'>"+a["data is hide"]+"</div><div class='kSectionBody'><div class='kSectionViewStatus'><span class='glyphicon glyphicon-wrench kBtnSpan'></span><span class='glyphicon glyphicon-save kBtnSpan'></span><span class='kSectionSaveStatus'>"+
a["section ok"]+"</span><br><span class='glyphicon glyphicon-registration-mark kBtnSpan'></span><span class='glyphicon glyphicon-copyright-mark kBtnSpan'></span><span class='glyphicon glyphicon-picture kBtnSpan'></span><span class='glyphicon glyphicon-file kBtnSpan'></span>&nbsp;&nbsp;&nbsp;<span class='glyphicon glyphicon-collapse-down kBtnSpan'></span><div class='KKeySidebarView'><table class='table'>");for(var f=0;f<g.length;f++){m.push("<tr>");var A=g[f],n;for(n in A)"bar"==n?m.push("<td><a href='#"+
n+"' class='glyphicon glyphicon-minus-sign'></a></td>"):m.push("<td><a href='#"+n+"'>"+n+"</a></td>");m.push("</tr>")}m.push("</table></div></div><div class='kSectionView' style='display:none;'></div><div class='kSectionEdit'><textarea class='kEditor' wrap='off'></textarea></div></div></div>");var f=$(m.join("")),A=f.find(".kSectionTitle:first"),R=A.find(".kTitleName:first"),x=f.find(".kSectionHide:first"),l=f.find(".kSectionBody:first");n=f.find(".kSectionViewStatus:first");var y=f.find(".kSectionView:first"),
t=f.find(".kSectionEdit:first");r.append(f);var q=n.find(".kSectionSaveStatus:first"),w={ShowPreview:function(a){t.hide();y.html(a);y.show();prettyPrint()},Save:function(c){if(d==c)k.Show(a["warning.title"],a["data not need save"]);else{var S=this;$.ajax({url:"/Section/AjaxSave",type:"POST",dataType:"json",data:{id:b,val:c}}).done(function(b){0==b.Code?(d=c,S.UpdateStatus()):k.Show(a["err.title"],b.Emsg)}).fail(function(){k.Show(a["err.title"],a["err net"])})}},UpdateStatus:function(b){b||""==b?b==
d?q.text(a["section ok"]):q.text(a["section no"]):q.text(a["section ok"])}},z=t.find(".kEditor");(d||""==d)&&z.val(d);var B=Q.editor({uploadJson:"/Files/Upload?id="+b,fileManagerJson:"/Files/Find?id="+b,allowFileManager:!0}),u=function(){return{html:function(){return z.val()},push:function(a){z.val(z.val()+a);z.focus()},insert:function(a){var b=z.get()[0],c=b.selectionStart,d=b.selectionEnd,e=b.value;b.value=e.substring(0,c)+a+e.substring(d,e.length);b.selectionStart=b.selectionEnd=a.length+c;z.focus()}}}();
z.keyup(function(a){a=u.html();w.UpdateStatus(a)}).change(function(a){a=u.html();w.UpdateStatus(a)});d||""==d?w.ShowPreview(d):d="";var C=function(d){c!=d&&1==e&&(e=2,$.ajax({url:"/Section/AjaxRename",type:"POST",dataType:"json",data:{id:b,name:d}}).done(function(b){0==b.Code?(c=d,R.text(c),h.Name=c):k.Show(a["err.title"],b.Emsg)}).fail(function(){k.Show(a["err.title"],a["err net"])}).always(function(){e=1}))},L=function(c){1==e&&(e=2,$.ajax({url:"/Section/AjaxRemove",type:"POST",dataType:"json",
data:{id:b}}).done(function(c){if(0==c.Code){r.find("#"+D).remove();c=[];for(var d=0;d<v.length;d++)v[d].Id!=b&&c.push(v[d]);v=c}else E.Show(a["err.title"],c.Emsg)}).fail(function(){E.Show(a["err.title"],a["err net"])}).always(function(){e=1}))};A.find(".glyphicon-minus:first").click(function(a){x.toggle("fast");l.toggle("fast")});A.find(".glyphicon-wrench:first").click(function(b){J.Show(a["input section"],c,function(a,b){a.Hide();C(b)})});A.find(".glyphicon-remove:first").click(function(d){k.Show(a["msg warning"],
a["chapter erase"]+" - "+c+"<br>"+a["sure?"],function(a){a.Hide();L(b)})});n.find(".glyphicon-wrench:first").click(function(a){t.is(":visible")?(a=u.html(),w.ShowPreview(a)):(y.html(""),y.hide(),t.show())});n.find(".glyphicon-registration-mark:first").click(function(a){P.Show()});n.find(".glyphicon-copyright-mark:first").click(function(b){N.Show(a["input code"],"",function(a,b){a.Hide();""!=b&&(b="\n<pre class='prettyprint linenums'>"+I(b)+"</pre>",u.push(b),m=u.html(),y.html(m),w.UpdateStatus(m),
prettyPrint())})});n.find(".glyphicon-save:first").click(function(a){a=u.html();w.Save(a)});n.find(".glyphicon-picture:first").click(function(a){B.loadPlugin("image",function(){B.plugin.imageDialog({clickFn:function(a,b,c,d,e,h){u.push("\n<img src='"+a+"'>");B.hideDialog();a=u.html();y.html(a);w.UpdateStatus(a)}})})});n.find(".glyphicon-file:first").click(function(a){B.loadPlugin("insertfile",function(){B.plugin.fileDialog({clickFn:function(a,b){var c;u.push("\n<a href='"+a+"' target='_blank'>"+b+
"</a>");B.hideDialog();c=u.html();y.html(c);w.UpdateStatus(c)}})})});var F=n.find(".glyphicon-collapse-down:first"),G=n.find(".KKeySidebarView:first");F.click(function(a){G.is(":visible")?(G.hide("fast"),F.attr("class","glyphicon glyphicon-collapse-down kBtnSpan")):(G.show("fast"),F.attr("class","glyphicon glyphicon-collapse-up kBtnSpan"))});var H=!0;n.find("a").click(function(a){a=$(this).attr("href");a=a.substring(1);if("bar"==a)return H?(H=!1,$(this).attr("class","glyphicon glyphicon-plus-sign")):
(H=!0,$(this).attr("class","glyphicon glyphicon-minus-sign")),!1;if(a=p[a])a&&(u.insert(a),a=u.html(),y.html(a),w.UpdateStatus(a)),H&&(G.hide("fast"),F.attr("class","glyphicon glyphicon-collapse-down kBtnSpan"));return!1})},D=function(b){v=[];$.ajax({url:"/Section/AjaxFind",type:"POST",dataType:"json",data:{panel:b}}).done(function(a){if(0==a.Code){r.html("");if(a=a.Data)for(var b=0;b<a.length;b++){var c=a[b];m(c.Id,c.Name,c.Str)}t.show();e=1}else r.html(a.Emsg)}).fail(function(){r.html(a["err net"])})};
D(b);d.find(".kBtnTop:first").click(function(a){location.href="#top"});d.find(".kBtnMenuHide:first").click(function(a){l.toggle("fast");x.toggle("fast")});d.find(".kBtnMenuSort:first").click(function(c){1==e&&0!=v.length&&M.Show(v,function(c){1==e&&(e=2,c=c.join("-"),$.ajax({url:"/Section/AjaxSort",type:"POST",dataType:"json",data:{sort:c}}).done(function(c){0==c.Code?(r.html(a["wait init data"]),D(b)):k.Show(a["err.title"],c.Emsg)}).fail(function(){k.Show(a["err.title"],a["err net"])}).always(function(){e=
1}))})});t.click(function(c){if(1==e){var d=a["new section"];e=2;$.ajax({url:"/Section/AjaxNew",type:"POST",dataType:"json",data:{panel:b,name:d}}).done(function(b){0==b.Code?m(b.Value,d):k.Show(a["err.title"],b.Emsg)}).fail(function(){k.Show(a["err.title"],a["err net"])}).always(function(){e=1})}});return{Rename:function(a){f.text(a)},Remove:function(){d.remove()}}},l=function(){var c=!0,g=$("#idBtnToggle"),e=$("#idBodyHide"),l=$("#idBodyView");g.click(function(a){e.toggle("fast");l.toggle("jqView")});
var d=$("#idListPanel"),f=[],p=function(){var a={};d.children("li").each(function(b,c){var d=$(c),e=d.attr("id");a[e]=d});for(var b=0;b<f.length;b++)d.append(a[f[b]])};d.sortable({update:function(b,e){if(!c)return!1;var h=d.sortable("toArray"),m=h.join("-");c=!1;$.ajax({url:"/Panel/AjaxSort",type:"POST",dataType:"json",data:{sort:m}}).done(function(b){0==b.Code?f=h:(p(),k.Show(a["err.title"],b.Emsg))}).fail(function(){p();k.Show(a["err.title"],a["err net"])}).always(function(){c=!0})}}).disableSelection();
var q=null,r=null,t=null,v=function(b,e){f.push(b);var h=$("<li class='list-group-item' id='"+b+"'><span data-id='"+b+"' class='glyphicon glyphicon-wrench kBtnSpan'></span><span data-id='"+b+"' class='glyphicon glyphicon-remove kBtnSpan'></span><a href='#panel-"+b+"'>"+e+"</a></li>"),g=h.find("a:first");d.append(h);q&&q(b,e);var m=function(d){d!=e&&c&&(c=!1,$.ajax({url:"/Panel/AjaxRename",type:"POST",dataType:"json",data:{id:b,name:d}}).done(function(c){0==c.Code?(e=d,g.text(e),r&&r(b,e)):k.Show(a["err.title"],
c.Emsg)}).fail(function(){k.Show(a["err.title"],a["err net"])}).always(function(){c=!0}))},l=function(b){c&&(c=!1,$.ajax({url:"/Panel/AjaxRemove",type:"POST",dataType:"json",data:{id:b}}).done(function(c){0==c.Code?(t&&t(b,e),h.remove()):E.Show(a["err.title"],c.Emsg)}).fail(function(){E.Show(a["err.title"],a["err net"])}).always(function(){c=!0}))};h.find(".glyphicon-wrench").click(function(b){J.Show(a["input chapter"],e,function(a,b){a.Hide();m(b)})});h.find(".glyphicon-remove").click(function(c){k.Show(a["msg warning"],
a["panel erase"]+" - "+e+"<br>"+a["sure?"],function(a){a.Hide();l(b)})})};$("#idBtnNewPanel").click(function(d){if(c){c=!1;var e=a["new panel"];$.ajax({url:"/Panel/AjaxNew",type:"POST",dataType:"json",data:{chapter:b.Chapter.Id,name:e}}).done(function(b){0==b.Code?v(b.Value,e):k.Show(a["err.title"],b.Emsg)}).fail(function(){k.Show(a["err.title"],a["err net"])}).always(function(){c=!0})}});return{Bind:function(a,b){"item.new"==a?q=b:"item.rename"==a?r=b:"item.remove"==a&&(t=b)},New:function(a,b){v(a,
b)}}}(),C={};l.Bind("item.new",function(a,b){C[a]=T(a,b)});l.Bind("item.rename",function(a,b){C[a].Rename(b)});l.Bind("item.remove",function(a,b){C[a].Remove();delete C[a]});q=b.Panels;for(c=0;c<q.length;c++){var K=q[c];l.New(K.Id,K.Name)}};
