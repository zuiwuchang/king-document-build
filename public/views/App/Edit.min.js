var $jscomp={scope:{},findInternal:function(b,a,g){b instanceof String&&(b=String(b));for(var p=b.length,m=0;m<p;m++){var f=b[m];if(a.call(g,f,m,b))return{i:m,v:f}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,g){if(g.get||g.set)throw new TypeError("ES3 does not support getters and setters.");b!=Array.prototype&&b!=Object.prototype&&(b[a]=g.value)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,a,g,p){if(a){g=$jscomp.global;b=b.split(".");for(p=0;p<b.length-1;p++){var m=b[p];m in g||(g[m]={});g=g[m]}b=b[b.length-1];p=g[b];a=a(p);a!=p&&null!=a&&$jscomp.defineProperty(g,b,{configurable:!0,writable:!0,value:a})}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6-impl","es3");
var NewContext=function(b){var a=b.Language,g=function(){var a=$("#idBtnSort"),b=$("#idModalSortBody");b.sortable().disableSelection();var e=$("#idModalSortSure"),f=$("#idModalSortCancel"),d=null,h=null;e.click(function(a){f.click();if(d){var c=[],e=!1;b.children("li").each(function(a,b){var d=$(b).data("id");c.push(d);e||d==h[a].Id||(e=!0)});e&&d(c)}});return{Show:function(c,e){h=c;d=e;for(var n="",x=0;x<c.length;x++)var f=c[x],n=n+("<li class='list-group-item' data-id='"+f.Id+"'>"+f.Name+"</li>");
b.html(n);a.click()}}}(),p=function(){var a=$("#idBtnModalInput"),b=$("#idModalInputTitle"),e=$("#idModalInputBody"),f=$("#idModalInputSure"),d=$("#idModalInputCancel"),h=null,g={Show:function(c,d,f){f&&(h=f);b.html(c);e.val(d);a.click();setTimeout(function(){e.select().focus()},200)},Hide:function(){d.click()}},l=function(){if(h){var a=e.val();h(g,a)}else d.click()};f.click(function(a){l()});e.keydown(function(a){13==a.keyCode&&l()});return g}(),m=function(){var a=$("#idBtnModalTextarea"),b=$("#idModalTextareaTitle"),
e=$("#idModalTextareaBody"),f=$("#idModalTextareaSure"),d=$("#idModalTextareaCancel"),h=null,g={Show:function(c,d,f){f&&(h=f);b.html(c);e.val(d);a.click();setTimeout(function(){e.select().focus()},200)},Hide:function(){d.click()},Reset:function(){e.val("")}};f.click(function(a){h?(a=e.val(),h(g,a)):d.click()});return g}(),f=function(){var a=$("#idBtnModalMsg"),b=$("#idModalMsgTitle"),e=$("#idModalMsgBody"),f=$("#idModalMsgSure"),d=$("#idModalMsgCancel"),h=null,g={Show:function(c,d,f){f&&(h=f);b.html(c);
e.html(d);a.click()},Hide:function(){d.click()}};f.click(function(a){h?h(g):d.click()});return g}(),I=kingui,k=1,C=function(b){var c=null,e={Hide:function(){f.Hide()},Show:function(a,b,e){c=e;f.Show(a,b)}},f=I.NewMsg({Id:b,Btns:[{Name:a.Sure,Callback:function(){c?c.bind(e)():this.Hide()}},{Name:a.Cancel}]});return e}(k++),E=function(a){var b=document.createElement("div");a=document.createTextNode(a);b.appendChild(a);return b.innerHTML},J=function(){var a=$("#idBtnModalHtml"),b=$("#idModalHtmlBtnCode"),
f=$("#idModalHtmlBtnOk"),g=$("#idModalHtmlBody"),d=$("#idModalHtmlVal");f.click(function(a){a=g.val();a=E(a);d.val(a)});b.click(function(a){a=g.val();a=E(a);d.val("<pre class='prettyprint linenums'>"+a+"</pre>")});return{Show:function(){g.val("");d.val("");a.click();setTimeout(function(){g.select().focus()},200)}}}(),K=b.K,N=function(b,x){var e=0,c=$("#idPanelsView"),d=$("<div class='panel panel-default'><a name='panel-"+b+"'></a><div class='panel-heading'><span class='glyphicon glyphicon-asterisk kBtnSpan kBtnTop'></span><span class='glyphicon glyphicon-minus kBtnSpan kBtnMenuHide'></span><span class='glyphicon glyphicon-sort-by-attributes kBtnSpan kBtnMenuSort'></span><span class='kPanelName'>"+
x+"</span></div><div class='panel-body'><div class='kPanelHide' style='display: none;'>"+a["data is hide"]+"</div><div class='kPanelBody'><div class='kPanelBodyView'>"+a["wait init data"]+"</div><div class='kSectionNode'><span class='glyphicon glyphicon-plus kBtnSpan kBtnAddSection'></span></div></div></div></div>");c.append(d);var h=d.find(".kPanelName:first"),k=d.find(".kPanelHide:first"),l=d.find(".kPanelBody:first"),n=l.find(".kPanelBodyView:first"),q=d.find(".kBtnAddSection:first");q.hide();
var r=[],t=function(b,d,c){var g={Id:b,Name:d};r.push(g);var A="king-section-"+b,t="<div id='"+A+"'><h4 class='kSectionTitle'><span class='glyphicon glyphicon-minus kBtnSpan'></span><span class='glyphicon glyphicon-wrench kBtnSpan'></span><span class='glyphicon glyphicon-remove kBtnSpan'></span><span class='kTitleName'>"+d+"</span></h4><div class='kSectionHide'>"+a["data is hide"]+"</div><div class='kSectionBody'><div class='kSectionViewStatus'><span class='glyphicon glyphicon-wrench kBtnSpan'></span><span class='glyphicon glyphicon-save kBtnSpan'></span><span class='kSectionSaveStatus'>"+
a["section ok"]+"</span><br><span class='glyphicon glyphicon-registration-mark kBtnSpan'></span><span class='glyphicon glyphicon-copyright-mark kBtnSpan'></span><span class='glyphicon glyphicon-picture kBtnSpan'></span><span class='glyphicon glyphicon-file kBtnSpan'></span></div><div class='kSectionView'></div><div class='kSectionEdit'><textarea class='kEditor' wrap='off'></textarea></div></div></div>",h=$(t),D=h.find(".kSectionTitle:first"),L=D.find(".kTitleName:first"),M=h.find(".kSectionHide:first"),
x=h.find(".kSectionBody:first"),l=h.find(".kSectionViewStatus:first"),k=h.find(".kSectionView:first"),q=h.find(".kSectionEdit:first");n.append(h);var w=l.find(".kSectionSaveStatus:first"),v={ShowPreview:function(a){q.hide();k.html(a);k.show();prettyPrint()},Save:function(d){if(c==d)f.Show(a["warning.title"],a["data not need save"]);else{var e=this;$.ajax({url:"/Section/AjaxSave",type:"POST",dataType:"json",data:{id:b,val:d}}).done(function(b){0==b.Code?(c=d,e.UpdateStatus()):f.Show(a["err.title"],
b.Emsg)}).fail(function(){f.Show(a["err.title"],a["err net"])})}},UpdateStatus:function(b){b||""==b?b==c?w.text(a["section ok"]):w.text(a["section no"]):w.text(a["section ok"])}},z=q.find(".kEditor");(c||""==c)&&z.val(c);var y=K.editor({uploadJson:"/Files/Upload?id="+b,fileManagerJson:"/Files/Find?id="+b,allowFileManager:!0}),u=function(){return{html:function(){return z.val()},push:function(a){z.val(z.val()+a)}}}();z.keyup(function(a){a=u.html();v.UpdateStatus(a)}).change(function(a){a=u.html();v.UpdateStatus(a)});
c||""==c?v.ShowPreview(c):c="";var B=function(c){d!=c&&1==e&&(e=2,$.ajax({url:"/Section/AjaxRename",type:"POST",dataType:"json",data:{id:b,name:c}}).done(function(b){0==b.Code?(d=c,L.text(d),g.Name=d):f.Show(a["err.title"],b.Emsg)}).fail(function(){f.Show(a["err.title"],a["err net"])}).always(function(){e=1}))},H=function(c){1==e&&(e=2,$.ajax({url:"/Section/AjaxRemove",type:"POST",dataType:"json",data:{id:b}}).done(function(c){if(0==c.Code){n.find("#"+A).remove();c=[];for(var d=0;d<r.length;d++)r[d].Id!=
b&&c.push(r[d]);r=c}else C.Show(a["err.title"],c.Emsg)}).fail(function(){C.Show(a["err.title"],a["err net"])}).always(function(){e=1}))};D.find(".glyphicon-minus:first").click(function(a){M.toggle("fast");x.toggle("fast")});D.find(".glyphicon-wrench:first").click(function(b){p.Show(a["input section"],d,function(a,b){a.Hide();B(b)})});D.find(".glyphicon-remove:first").click(function(c){f.Show(a["msg warning"],a["chapter erase"]+" - "+d+"<br>"+a["sure?"],function(a){a.Hide();H(b)})});l.find(".glyphicon-wrench:first").click(function(a){q.is(":visible")?
(a=u.html(),v.ShowPreview(a)):(k.html(""),k.hide(),q.show())});l.find(".glyphicon-registration-mark:first").click(function(a){J.Show()});l.find(".glyphicon-copyright-mark:first").click(function(b){m.Show(a["input code"],"",function(a,b){a.Hide();""!=b&&(b="\n<pre class='prettyprint linenums'>"+E(b)+"</pre>",u.push(b),t=u.html(),k.html(t),v.UpdateStatus(t))})});l.find(".glyphicon-save:first").click(function(a){a=u.html();v.Save(a)});l.find(".glyphicon-picture:first").click(function(a){y.loadPlugin("image",
function(){y.plugin.imageDialog({clickFn:function(a,b,c,d,f,e){u.push("\n<img src='"+a+"'>");y.hideDialog();a=u.html();k.html(a);v.UpdateStatus(a)}})})});l.find(".glyphicon-file:first").click(function(a){y.loadPlugin("insertfile",function(){y.plugin.fileDialog({clickFn:function(a,b){var c;u.push("\n<a href='"+a+"' target='_blank'>"+b+"</a>");y.hideDialog();c=u.html();k.html(c);v.UpdateStatus(c)}})})})},A=function(b){r=[];$.ajax({url:"/Section/AjaxFind",type:"POST",dataType:"json",data:{panel:b}}).done(function(a){if(0==
a.Code){n.html("");if(a=a.Data)for(var b=0;b<a.length;b++){var c=a[b];t(c.Id,c.Name,c.Str)}q.show();e=1}else n.html(a.Emsg)}).fail(function(){n.html(a["err net"])})};A(b);d.find(".kBtnTop:first").click(function(a){location.href="#top"});d.find(".kBtnMenuHide:first").click(function(a){k.toggle("fast");l.toggle("fast")});d.find(".kBtnMenuSort:first").click(function(c){1==e&&0!=r.length&&g.Show(r,function(c){1==e&&(e=2,c=c.join("-"),$.ajax({url:"/Section/AjaxSort",type:"POST",dataType:"json",data:{sort:c}}).done(function(c){0==
c.Code?(n.html(a["wait init data"]),A(b)):f.Show(a["err.title"],c.Emsg)}).fail(function(){f.Show(a["err.title"],a["err net"])}).always(function(){e=1}))})});q.click(function(c){if(1==e){var d=a["new section"];e=2;$.ajax({url:"/Section/AjaxNew",type:"POST",dataType:"json",data:{panel:b,name:d}}).done(function(b){0==b.Code?t(b.Value,d):f.Show(a["err.title"],b.Emsg)}).fail(function(){f.Show(a["err.title"],a["err net"])}).always(function(){e=1})}});return{Rename:function(a){h.text(a)},Remove:function(){d.remove()}}},
k=function(){var c=!0,g=$("#idBtnToggle"),e=$("#idBodyHide"),k=$("#idBodyView");g.click(function(a){e.toggle("fast");k.toggle("jqView")});var d=$("#idListPanel"),h=[],m=function(){var a={};d.children("li").each(function(b,c){var d=$(c),f=d.attr("id");a[f]=d});for(var b=0;b<h.length;b++)d.append(a[h[b]])};d.sortable({update:function(b,e){if(!c)return!1;var g=d.sortable("toArray"),t=g.join("-");c=!1;$.ajax({url:"/Panel/AjaxSort",type:"POST",dataType:"json",data:{sort:t}}).done(function(b){0==b.Code?
h=g:(m(),f.Show(a["err.title"],b.Emsg))}).fail(function(){m();f.Show(a["err.title"],a["err net"])}).always(function(){c=!0})}}).disableSelection();var l=null,n=null,q=null,r=function(b,e){h.push(b);var g=$("<li class='list-group-item' id='"+b+"'><span data-id='"+b+"' class='glyphicon glyphicon-wrench kBtnSpan'></span><span data-id='"+b+"' class='glyphicon glyphicon-remove kBtnSpan'></span><a href='#panel-"+b+"'>"+e+"</a></li>"),k=g.find("a:first");d.append(g);l&&l(b,e);var t=function(d){d!=e&&c&&
(c=!1,$.ajax({url:"/Panel/AjaxRename",type:"POST",dataType:"json",data:{id:b,name:d}}).done(function(c){0==c.Code?(e=d,k.text(e),n&&n(b,e)):f.Show(a["err.title"],c.Emsg)}).fail(function(){f.Show(a["err.title"],a["err net"])}).always(function(){c=!0}))},m=function(b){c&&(c=!1,$.ajax({url:"/Panel/AjaxRemove",type:"POST",dataType:"json",data:{id:b}}).done(function(c){0==c.Code?(q&&q(b,e),g.remove()):C.Show(a["err.title"],c.Emsg)}).fail(function(){C.Show(a["err.title"],a["err net"])}).always(function(){c=
!0}))};g.find(".glyphicon-wrench").click(function(b){p.Show(a["input chapter"],e,function(a,b){a.Hide();t(b)})});g.find(".glyphicon-remove").click(function(c){f.Show(a["msg warning"],a["panel erase"]+" - "+e+"<br>"+a["sure?"],function(a){a.Hide();m(b)})})};$("#idBtnNewPanel").click(function(d){if(c){c=!1;var e=a["new panel"];$.ajax({url:"/Panel/AjaxNew",type:"POST",dataType:"json",data:{chapter:b.Chapter.Id,name:e}}).done(function(b){0==b.Code?r(b.Value,e):f.Show(a["err.title"],b.Emsg)}).fail(function(){f.Show(a["err.title"],
a["err net"])}).always(function(){c=!0})}});return{Bind:function(a,b){"item.new"==a?l=b:"item.rename"==a?n=b:"item.remove"==a&&(q=b)},New:function(a,b){r(a,b)}}}(),w={};k.Bind("item.new",function(a,b){w[a]=N(a,b)});k.Bind("item.rename",function(a,b){w[a].Rename(b)});k.Bind("item.remove",function(a,b){w[a].Remove();delete w[a]});for(var F=b.Panels,B=0;B<F.length;B++){var G=F[B];k.New(G.Id,G.Name)}};
