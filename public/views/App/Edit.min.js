var $jscomp={scope:{},findInternal:function(b,a,h){b instanceof String&&(b=String(b));for(var r=b.length,k=0;k<r;k++){var f=b[k];if(a.call(h,f,k,b))return{i:k,v:f}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,h){if(h.get||h.set)throw new TypeError("ES3 does not support getters and setters.");b!=Array.prototype&&b!=Object.prototype&&(b[a]=h.value)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,a,h,r){if(a){h=$jscomp.global;b=b.split(".");for(r=0;r<b.length-1;r++){var k=b[r];k in h||(h[k]={});h=h[k]}b=b[b.length-1];r=h[b];a=a(r);a!=r&&null!=a&&$jscomp.defineProperty(h,b,{configurable:!0,writable:!0,value:a})}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6-impl","es3");
var NewContext=function(b){var a=b.Language,h=function(){var a=$("#idBtnSort"),b=$("#idModalSortBody");b.sortable().disableSelection();var e=$("#idModalSortSure"),n=$("#idModalSortCancel"),d=null,g=null;e.click(function(a){n.click();if(d){var c=[],e=!1;b.children("li").each(function(a,b){var d=$(b).data("id");c.push(d);e||d==g[a].Id||(e=!0)});e&&d(c)}});return{Show:function(c,e){g=c;d=e;for(var l="",n=0;n<c.length;n++)var f=c[n],l=l+("<li class='list-group-item' data-id='"+f.Id+"'>"+f.Name+"</li>");
b.html(l);a.click()}}}(),r=function(){var a=$("#idBtnModalInput"),b=$("#idModalInputTitle"),e=$("#idModalInputBody"),n=$("#idModalInputSure"),d=$("#idModalInputCancel"),g=null,f={Show:function(c,d,l){l&&(g=l);b.html(c);e.val(d);a.click();setTimeout(function(){e.select().focus()},200)},Hide:function(){d.click()}},p=function(){if(g){var a=e.val();g(f,a)}else d.click()};n.click(function(a){p()});e.keydown(function(a){13==a.keyCode&&p()});return f}(),k=function(){var a=$("#idBtnModalTextarea"),b=$("#idModalTextareaTitle"),
e=$("#idModalTextareaBody"),n=$("#idModalTextareaSure"),d=$("#idModalTextareaCancel"),g=null,f={Show:function(c,d,f){f&&(g=f);b.html(c);e.val(d);a.click();setTimeout(function(){e.select().focus()},200)},Hide:function(){d.click()},Reset:function(){e.val("")}};n.click(function(a){g?(a=e.val(),g(f,a)):d.click()});return f}(),f=function(){var a=$("#idBtnModalMsg"),b=$("#idModalMsgTitle"),e=$("#idModalMsgBody"),f=$("#idModalMsgSure"),d=$("#idModalMsgCancel"),g=null,h={Show:function(c,d,f){f&&(g=f);b.html(c);
e.html(d);a.click()},Hide:function(){d.click()}};f.click(function(a){g?g(h):d.click()});return h}(),E=kingui,q=1,z=function(c){var b=null,e={Hide:function(){f.Hide()},Show:function(a,c,e){b=e;f.Show(a,c)}},f=E.NewMsg({Id:c,Btns:[{Name:a.Sure,Callback:function(){b?b.bind(e)():this.Hide()}},{Name:a.Cancel}]});return e}(q++),y=function(a){var b=document.createElement("div");a=document.createTextNode(a);b.appendChild(a);return b.innerHTML},F=function(){var a=$("#idBtnModalHtml"),b=$("#idModalHtmlBtnCode"),
e=$("#idModalHtmlBtnOk"),f=$("#idModalHtmlBody"),d=$("#idModalHtmlVal");e.click(function(a){a=f.val();a=y(a);d.val(a)});b.click(function(a){a=f.val();a=y(a);d.val("<pre class='prettyprint linenums'>"+a+"</pre>")});return{Show:function(){f.val("");d.val("");a.click();setTimeout(function(){f.select().focus()},200)}}}();KindEditor.plugin("mycode",function(b){var f=this;f.clickToolbar("mycode",function(){k.Show(a["input code"],"",function(a,b){a.Hide();""!=b&&(b="<pre class='prettyprint linenums'>"+y(b)+
"</pre>",f.insertHtml(b))})})});KindEditor.lang({mycode:a["insert code"]});var I=function(b,l){var e=0,c=$("#idPanelsView"),d=$("<div class='panel panel-default'><a name='panel-"+b+"'></a><div class='panel-heading'><span class='glyphicon glyphicon-asterisk kBtnSpan kBtnTop'></span><span class='glyphicon glyphicon-minus kBtnSpan kBtnMenuHide'></span><span class='glyphicon glyphicon-sort-by-attributes kBtnSpan kBtnMenuSort'></span><span class='kPanelName'>"+l+"</span></div><div class='panel-body'><div class='kPanelHide' style='display: none;'>"+
a["data is hide"]+"</div><div class='kPanelBody'><div class='kPanelBodyView'>"+a["wait init data"]+"</div><div class='kSectionNode'><span class='glyphicon glyphicon-plus kBtnSpan kBtnAddSection'></span></div></div></div></div>");c.append(d);var g=d.find(".kPanelName:first"),k=d.find(".kPanelHide:first"),p=d.find(".kPanelBody:first"),u=p.find(".kPanelBodyView:first"),m=d.find(".kBtnAddSection:first");m.hide();var t=[],x=function(b,d,c){var v={Id:b,Name:d};t.push(v);var x="king-section-"+b,g=$("<div id='"+
x+"'><h4 class='kSectionTitle'><span class='glyphicon glyphicon-minus kBtnSpan'></span><span class='glyphicon glyphicon-wrench kBtnSpan'></span><span class='glyphicon glyphicon-remove kBtnSpan'></span><span class='kTitleName'>"+d+"</span></h4><div class='kSectionHide'>"+a["data is hide"]+"</div><div class='kSectionBody'><div class='kSectionViewStatus'><span class='glyphicon glyphicon-wrench kBtnSpan'></span><span class='glyphicon glyphicon-copyright-mark kBtnSpan'></span><span class='glyphicon glyphicon-save kBtnSpan'></span><span class='kSectionSaveStatus'>"+
a["section ok"]+"</span></div><div class='kSectionView'></div><div class='kSectionEdit'><textarea class='kEditor'></textarea></div></div></div>"),A=g.find(".kSectionTitle:first"),G=A.find(".kTitleName:first"),h=g.find(".kSectionHide:first"),H=g.find(".kSectionBody:first"),l=g.find(".kSectionViewStatus:first"),k=g.find(".kSectionView:first"),n=g.find(".kSectionEdit:first");u.append(g);var p=l.find(".kSectionSaveStatus:first"),m={ShowPreview:function(a){n.hide();k.html(a);k.show();prettyPrint()},Save:function(d){if(c==
d)f.Show(a["warning.title"],a["data not need save"]);else{var e=this;$.ajax({url:"/Section/AjaxSave",type:"POST",dataType:"json",data:{id:b,val:d}}).done(function(b){0==b.Code?(c=d,e.UpdateStatus()):f.Show(a["err.title"],b.Emsg)}).fail(function(){f.Show(a["err.title"],a["err net"])})}},UpdateStatus:function(b){b||""==b?b==c?p.text(a["section ok"]):p.text(a["section no"]):p.text(a["section ok"])}},g=n.find(".kEditor");(c||""==c)&&g.val(c);var q=KindEditor.create(g,{uploadJson:"/Files/Upload?id="+b,
fileManagerJson:"/Files/Find?id="+b,allowFileManager:!0,urlType:"relative",resizeType:1,width:"100%",height:400,items:["source","|","undo","redo","|","mycode","|","cut","copy","paste","plainpaste","|","justifyleft","justifycenter","justifyright","justifyfull","insertorderedlist","insertunorderedlist","indent","outdent","subscript","superscript","clearhtml","selectall","|","fullscreen","/","bold","italic","underline","strikethrough","lineheight","removeformat","|","image","insertfile","table","link",
"unlink",,],afterCreate:function(){m._isCreate=!0},afterChange:function(){if(m._isCreate){var a=this.html();m.UpdateStatus(a)}}});q._k_ctx=m;c||""==c?m.ShowPreview(c):c="";var w=function(c){d!=c&&1==e&&(e=2,$.ajax({url:"/Section/AjaxRename",type:"POST",dataType:"json",data:{id:b,name:c}}).done(function(b){0==b.Code?(d=c,G.text(d),v.Name=d):f.Show(a["err.title"],b.Emsg)}).fail(function(){f.Show(a["err.title"],a["err net"])}).always(function(){e=1}))},y=function(c){1==e&&(e=2,$.ajax({url:"/Section/AjaxRemove",
type:"POST",dataType:"json",data:{id:b}}).done(function(c){if(0==c.Code){u.find("#"+x).remove();c=[];for(var d=0;d<t.length;d++)t[d].Id!=b&&c.push(t[d]);t=c}else z.Show(a["err.title"],c.Emsg)}).fail(function(){z.Show(a["err.title"],a["err net"])}).always(function(){e=1}))};A.find(".glyphicon-minus:first").click(function(a){h.toggle("fast");H.toggle("fast")});A.find(".glyphicon-wrench:first").click(function(b){r.Show(a["input section"],d,function(a,b){a.Hide();w(b)})});A.find(".glyphicon-remove:first").click(function(c){f.Show(a["msg warning"],
a["chapter erase"]+" - "+d+"<br>"+a["sure?"],function(a){a.Hide();y(b)})});l.find(".glyphicon-wrench:first").click(function(a){n.is(":visible")?(a=q.html(),m.ShowPreview(a)):(k.html(""),k.hide(),n.show())});l.find(".glyphicon-copyright-mark:first").click(function(a){F.Show()});l.find(".glyphicon-save:first").click(function(a){a=q.html();m.Save(a)})},v=function(b){t=[];$.ajax({url:"/Section/AjaxFind",type:"POST",dataType:"json",data:{panel:b}}).done(function(a){if(0==a.Code){u.html("");if(a=a.Data)for(var b=
0;b<a.length;b++){var c=a[b];x(c.Id,c.Name,c.Str)}m.show();e=1}else u.html(a.Emsg)}).fail(function(){u.html(a["err net"])})};v(b);d.find(".kBtnTop:first").click(function(a){location.href="#top"});d.find(".kBtnMenuHide:first").click(function(a){k.toggle("fast");p.toggle("fast")});d.find(".kBtnMenuSort:first").click(function(c){1==e&&0!=t.length&&h.Show(t,function(c){1==e&&(e=2,c=c.join("-"),$.ajax({url:"/Section/AjaxSort",type:"POST",dataType:"json",data:{sort:c}}).done(function(c){0==c.Code?(u.html(a["wait init data"]),
v(b)):f.Show(a["err.title"],c.Emsg)}).fail(function(){f.Show(a["err.title"],a["err net"])}).always(function(){e=1}))})});m.click(function(c){if(1==e){var d=a["new section"];e=2;$.ajax({url:"/Section/AjaxNew",type:"POST",dataType:"json",data:{panel:b,name:d}}).done(function(b){0==b.Code?x(b.Value,d):f.Show(a["err.title"],b.Emsg)}).fail(function(){f.Show(a["err.title"],a["err net"])}).always(function(){e=1})}});return{Rename:function(a){g.text(a)},Remove:function(){d.remove()}}},q=function(){var c=
!0,h=$("#idBtnToggle"),e=$("#idBodyHide"),k=$("#idBodyView");h.click(function(a){e.toggle("fast");k.toggle("jqView")});var d=$("#idListPanel"),g=[],q=function(){var a={};d.children("li").each(function(b,c){var d=$(c),f=d.attr("id");a[f]=d});for(var b=0;b<g.length;b++)d.append(a[g[b]])};d.sortable({update:function(b,e){if(!c)return!1;var v=d.sortable("toArray"),h=v.join("-");c=!1;$.ajax({url:"/Panel/AjaxSort",type:"POST",dataType:"json",data:{sort:h}}).done(function(b){0==b.Code?g=v:(q(),f.Show(a["err.title"],
b.Emsg))}).fail(function(){q();f.Show(a["err.title"],a["err net"])}).always(function(){c=!0})}}).disableSelection();var p=null,u=null,m=null,t=function(b,e){g.push(b);var h=$("<li class='list-group-item' id='"+b+"'><span data-id='"+b+"' class='glyphicon glyphicon-wrench kBtnSpan'></span><span data-id='"+b+"' class='glyphicon glyphicon-remove kBtnSpan'></span><a href='#panel-"+b+"'>"+e+"</a></li>"),k=h.find("a:first");d.append(h);p&&p(b,e);var l=function(d){d!=e&&c&&(c=!1,$.ajax({url:"/Panel/AjaxRename",
type:"POST",dataType:"json",data:{id:b,name:d}}).done(function(c){0==c.Code?(e=d,k.text(e),u&&u(b,e)):f.Show(a["err.title"],c.Emsg)}).fail(function(){f.Show(a["err.title"],a["err net"])}).always(function(){c=!0}))},v=function(b){c&&(c=!1,$.ajax({url:"/Panel/AjaxRemove",type:"POST",dataType:"json",data:{id:b}}).done(function(c){0==c.Code?(m&&m(b,e),h.remove()):z.Show(a["err.title"],c.Emsg)}).fail(function(){z.Show(a["err.title"],a["err net"])}).always(function(){c=!0}))};h.find(".glyphicon-wrench").click(function(b){r.Show(a["input chapter"],
e,function(a,b){a.Hide();l(b)})});h.find(".glyphicon-remove").click(function(c){f.Show(a["msg warning"],a["panel erase"]+" - "+e+"<br>"+a["sure?"],function(a){a.Hide();v(b)})})};$("#idBtnNewPanel").click(function(d){if(c){c=!1;var e=a["new panel"];$.ajax({url:"/Panel/AjaxNew",type:"POST",dataType:"json",data:{chapter:b.Chapter.Id,name:e}}).done(function(b){0==b.Code?t(b.Value,e):f.Show(a["err.title"],b.Emsg)}).fail(function(){f.Show(a["err.title"],a["err net"])}).always(function(){c=!0})}});return{Bind:function(a,
b){"item.new"==a?p=b:"item.rename"==a?u=b:"item.remove"==a&&(m=b)},New:function(a,b){t(a,b)}}}(),w={};q.Bind("item.new",function(a,b){w[a]=I(a,b)});q.Bind("item.rename",function(a,b){w[a].Rename(b)});q.Bind("item.remove",function(a,b){w[a].Remove();delete w[a]});for(var C=b.Panels,B=0;B<C.length;B++){var D=C[B];q.New(D.Id,D.Name)}};
