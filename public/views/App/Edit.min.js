var $jscomp={scope:{},findInternal:function(b,a,g){b instanceof String&&(b=String(b));for(var m=b.length,h=0;h<m;h++){var f=b[h];if(a.call(g,f,h,b))return{i:h,v:f}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,g){if(g.get||g.set)throw new TypeError("ES3 does not support getters and setters.");b!=Array.prototype&&b!=Object.prototype&&(b[a]=g.value)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,a,g,m){if(a){g=$jscomp.global;b=b.split(".");for(m=0;m<b.length-1;m++){var h=b[m];h in g||(g[h]={});g=g[h]}b=b[b.length-1];m=g[b];a=a(m);a!=m&&null!=a&&$jscomp.defineProperty(g,b,{configurable:!0,writable:!0,value:a})}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6-impl","es3");
var NewContext=function(b){var a=b.Language,g=function(){var a=$("#idBtnSort"),b=$("#idModalSortBody");b.sortable().disableSelection();var e=$("#idModalSortSure"),t=$("#idModalSortCancel"),d=null,k=null;e.click(function(a){t.click();if(d){var c=[],e=!1;b.children("li").each(function(a,b){var d=$(b).data("id");c.push(d);e||d==k[a].Id||(e=!0)});e&&d(c)}});return{Show:function(c,e){k=c;d=e;for(var r="",t=0;t<c.length;t++)var f=c[t],r=r+("<li class='list-group-item' data-id='"+f.Id+"'>"+f.Name+"</li>");
b.html(r);a.click()}}}(),m=function(){var a=$("#idBtnModalInput"),b=$("#idModalInputTitle"),e=$("#idModalInputBody"),t=$("#idModalInputSure"),d=$("#idModalInputCancel"),f=null,g={Show:function(c,d,r){r&&(f=r);b.html(c);e.val(d);a.click();setTimeout(function(){e.select().focus()},200)},Hide:function(){d.click()}},p=function(){if(f){var a=e.val();f(g,a)}else d.click()};t.click(function(a){p()});e.keydown(function(a){13==a.keyCode&&p()});return g}(),h=function(){var a=$("#idBtnModalTextarea"),b=$("#idModalTextareaTitle"),
e=$("#idModalTextareaBody"),f=$("#idModalTextareaSure"),d=$("#idModalTextareaCancel"),k=null,g={Show:function(c,d,f){f&&(k=f);b.html(c);e.val(d);a.click();setTimeout(function(){e.select().focus()},200)},Hide:function(){d.click()},Reset:function(){e.val("")}};f.click(function(a){k?(a=e.val(),k(g,a)):d.click()});return g}(),f=function(){var a=$("#idBtnModalMsg"),b=$("#idModalMsgTitle"),e=$("#idModalMsgBody"),f=$("#idModalMsgSure"),d=$("#idModalMsgCancel"),g=null,m={Show:function(c,d,f){f&&(g=f);b.html(c);
e.html(d);a.click()},Hide:function(){d.click()}};f.click(function(a){g?g(m):d.click()});return m}(),E=kingui,q=1,z=function(c){var b=null,e={Hide:function(){f.Hide()},Show:function(a,c,e){b=e;f.Show(a,c)}},f=E.NewMsg({Id:c,Btns:[{Name:a.Sure,Callback:function(){b?b.bind(e)():this.Hide()}},{Name:a.Cancel}]});return e}(q++),B=function(a){var b=document.createElement("div");a=document.createTextNode(a);b.appendChild(a);return b.innerHTML},F=function(){var a=$("#idBtnModalHtml"),b=$("#idModalBtnOk"),
e=$("#idModalHtmlBody"),f=$("#idModalHtmlVal");b.click(function(a){a=e.val();a=B(a);f.val(a)});return{Show:function(){a.click();setTimeout(function(){e.select().focus()},200)}}}();KindEditor.plugin("mycode",function(b){var f=this;f.clickToolbar("mycode",function(){h.Show(a["input code"],"",function(a,b){a.Hide();""!=b&&(b="<pre class='prettyprint linenums'>"+B(b)+"</pre>",f.insertHtml(b))})})});KindEditor.lang({mycode:a["insert code"]});var I=function(b,r){var e=0,c=$("#idPanelsView"),d=$("<div class='panel panel-default'><a name='panel-"+
b+"'></a><div class='panel-heading'><span class='glyphicon glyphicon-asterisk kBtnSpan kBtnTop'></span><span class='glyphicon glyphicon-minus kBtnSpan kBtnMenuHide'></span><span class='glyphicon glyphicon-sort-by-attributes kBtnSpan kBtnMenuSort'></span><span class='kPanelName'>"+r+"</span></div><div class='panel-body'><div class='kPanelHide' style='display: none;'>"+a["data is hide"]+"</div><div class='kPanelBody'><div class='kPanelBodyView'>"+a["wait init data"]+"</div><div class='kSectionNode'><span class='glyphicon glyphicon-plus kBtnSpan kBtnAddSection'></span></div></div></div></div>");
c.append(d);var k=d.find(".kPanelName:first"),h=d.find(".kPanelHide:first"),p=d.find(".kPanelBody:first"),v=p.find(".kPanelBodyView:first"),n=d.find(".kBtnAddSection:first");n.hide();var u=[],l=function(b,c,d){var x={Id:b,Name:c};u.push(x);var g="king-section-"+b,l=$("<div id='"+g+"'><h4 class='kSectionTitle'><span class='glyphicon glyphicon-minus kBtnSpan'></span><span class='glyphicon glyphicon-wrench kBtnSpan'></span><span class='glyphicon glyphicon-remove kBtnSpan'></span><span class='kTitleName'>"+
c+"</span></h4><div class='kSectionHide'>"+a["data is hide"]+"</div><div class='kSectionBody'><div class='kSectionViewStatus'><span class='glyphicon glyphicon-wrench kBtnSpan'></span><span class='glyphicon glyphicon-copyright-mark kBtnSpan'></span><span class='glyphicon glyphicon-save kBtnSpan'></span><span class='kSectionSaveStatus'>"+a["section ok"]+"</span></div><div class='kSectionView'></div><div class='kSectionEdit'><textarea class='kEditor'></textarea></div></div></div>"),A=l.find(".kSectionTitle:first"),
G=A.find(".kTitleName:first"),H=l.find(".kSectionHide:first"),r=l.find(".kSectionBody:first"),h=l.find(".kSectionViewStatus:first"),k=l.find(".kSectionView:first"),t=l.find(".kSectionEdit:first");v.append(l);var p=h.find(".kSectionSaveStatus:first"),n={ShowPreview:function(a){t.hide();k.html(a);k.show();prettyPrint()},Save:function(c){if(d==c)f.Show(a["warning.title"],a["data not need save"]);else{var e=this;$.ajax({url:"/Section/AjaxSave",type:"POST",dataType:"json",data:{id:b,val:c}}).done(function(b){0==
b.Code?(d=c,e.UpdateStatus()):f.Show(a["err.title"],b.Emsg)}).fail(function(){f.Show(a["err.title"],a["err net"])})}},UpdateStatus:function(b){b||""==b?b==d?p.text(a["section ok"]):p.text(a["section no"]):p.text(a["section ok"])}},l=t.find(".kEditor");(d||""==d)&&l.val(d);var q=KindEditor.create(l,{uploadJson:"/Files/Upload?id="+b,fileManagerJson:"/Files/Find?id="+b,allowFileManager:!0,urlType:"relative",resizeType:1,width:"100%",height:400,items:["source","|","undo","redo","|","mycode","|","cut",
"copy","paste","plainpaste","|","justifyleft","justifycenter","justifyright","justifyfull","insertorderedlist","insertunorderedlist","indent","outdent","subscript","superscript","clearhtml","selectall","|","fullscreen","/","bold","italic","underline","strikethrough","lineheight","removeformat","|","image","insertfile","table","link","unlink",,],afterCreate:function(){n._isCreate=!0},afterChange:function(){if(n._isCreate){var a=this.html();n.UpdateStatus(a)}}});q._k_ctx=n;d||""==d?n.ShowPreview(d):
d="";var w=function(d){c!=d&&1==e&&(e=2,$.ajax({url:"/Section/AjaxRename",type:"POST",dataType:"json",data:{id:b,name:d}}).done(function(b){0==b.Code?(c=d,G.text(c),x.Name=c):f.Show(a["err.title"],b.Emsg)}).fail(function(){f.Show(a["err.title"],a["err net"])}).always(function(){e=1}))},y=function(c){1==e&&(e=2,$.ajax({url:"/Section/AjaxRemove",type:"POST",dataType:"json",data:{id:b}}).done(function(c){if(0==c.Code){v.find("#"+g).remove();c=[];for(var d=0;d<u.length;d++)u[d].Id!=b&&c.push(u[d]);u=
c}else z.Show(a["err.title"],c.Emsg)}).fail(function(){z.Show(a["err.title"],a["err net"])}).always(function(){e=1}))};A.find(".glyphicon-minus:first").click(function(a){H.toggle("fast");r.toggle("fast")});A.find(".glyphicon-wrench:first").click(function(b){m.Show(a["input section"],c,function(a,b){a.Hide();w(b)})});A.find(".glyphicon-remove:first").click(function(d){f.Show(a["msg warning"],a["chapter erase"]+" - "+c+"<br>"+a["sure?"],function(a){a.Hide();y(b)})});h.find(".glyphicon-wrench:first").click(function(a){k.is(":visible")?
(k.html(""),k.hide(),t.show()):(a=q.html(),n.ShowPreview(a))});h.find(".glyphicon-copyright-mark:first").click(function(a){F.Show()});h.find(".glyphicon-save:first").click(function(a){a=q.html();n.Save(a)})},x=function(b){u=[];$.ajax({url:"/Section/AjaxFind",type:"POST",dataType:"json",data:{panel:b}}).done(function(a){if(0==a.Code){v.html("");if(a=a.Data)for(var b=0;b<a.length;b++){var c=a[b];l(c.Id,c.Name,c.Str)}n.show();e=1}else v.html(a.Emsg)}).fail(function(){v.html(a["err net"])})};x(b);d.find(".kBtnTop:first").click(function(a){location.href=
"#top"});d.find(".kBtnMenuHide:first").click(function(a){h.toggle("fast");p.toggle("fast")});d.find(".kBtnMenuSort:first").click(function(c){1==e&&0!=u.length&&g.Show(u,function(c){1==e&&(e=2,c=c.join("-"),$.ajax({url:"/Section/AjaxSort",type:"POST",dataType:"json",data:{sort:c}}).done(function(c){0==c.Code?(v.html(a["wait init data"]),x(b)):f.Show(a["err.title"],c.Emsg)}).fail(function(){f.Show(a["err.title"],a["err net"])}).always(function(){e=1}))})});n.click(function(c){if(1==e){var d=a["new section"];
e=2;$.ajax({url:"/Section/AjaxNew",type:"POST",dataType:"json",data:{panel:b,name:d}}).done(function(b){0==b.Code?l(b.Value,d):f.Show(a["err.title"],b.Emsg)}).fail(function(){f.Show(a["err.title"],a["err net"])}).always(function(){e=1})}});return{Rename:function(a){k.text(a)},Remove:function(){d.remove()}}},q=function(){var c=!0,g=$("#idBtnToggle"),e=$("#idBodyHide"),h=$("#idBodyView");g.click(function(a){e.toggle("fast");h.toggle("jqView")});var d=$("#idListPanel"),k=[],q=function(){var a={};d.children("li").each(function(b,
c){var d=$(c),e=d.attr("id");a[e]=d});for(var b=0;b<k.length;b++)d.append(a[k[b]])};d.sortable({update:function(b,e){if(!c)return!1;var g=d.sortable("toArray"),l=g.join("-");c=!1;$.ajax({url:"/Panel/AjaxSort",type:"POST",dataType:"json",data:{sort:l}}).done(function(b){0==b.Code?k=g:(q(),f.Show(a["err.title"],b.Emsg))}).fail(function(){q();f.Show(a["err.title"],a["err net"])}).always(function(){c=!0})}}).disableSelection();var p=null,v=null,n=null,u=function(b,e){k.push(b);var g=$("<li class='list-group-item' id='"+
b+"'><span data-id='"+b+"' class='glyphicon glyphicon-wrench kBtnSpan'></span><span data-id='"+b+"' class='glyphicon glyphicon-remove kBtnSpan'></span><a href='#panel-"+b+"'>"+e+"</a></li>"),l=g.find("a:first");d.append(g);p&&p(b,e);var h=function(d){d!=e&&c&&(c=!1,$.ajax({url:"/Panel/AjaxRename",type:"POST",dataType:"json",data:{id:b,name:d}}).done(function(c){0==c.Code?(e=d,l.text(e),v&&v(b,e)):f.Show(a["err.title"],c.Emsg)}).fail(function(){f.Show(a["err.title"],a["err net"])}).always(function(){c=
!0}))},r=function(b){c&&(c=!1,$.ajax({url:"/Panel/AjaxRemove",type:"POST",dataType:"json",data:{id:b}}).done(function(c){0==c.Code?(n&&n(b,e),g.remove()):z.Show(a["err.title"],c.Emsg)}).fail(function(){z.Show(a["err.title"],a["err net"])}).always(function(){c=!0}))};g.find(".glyphicon-wrench").click(function(b){m.Show(a["input chapter"],e,function(a,b){a.Hide();h(b)})});g.find(".glyphicon-remove").click(function(c){f.Show(a["msg warning"],a["panel erase"]+" - "+e+"<br>"+a["sure?"],function(a){a.Hide();
r(b)})})};$("#idBtnNewPanel").click(function(d){if(c){c=!1;var e=a["new panel"];$.ajax({url:"/Panel/AjaxNew",type:"POST",dataType:"json",data:{chapter:b.Chapter.Id,name:e}}).done(function(b){0==b.Code?u(b.Value,e):f.Show(a["err.title"],b.Emsg)}).fail(function(){f.Show(a["err.title"],a["err net"])}).always(function(){c=!0})}});return{Bind:function(a,b){"item.new"==a?p=b:"item.rename"==a?v=b:"item.remove"==a&&(n=b)},New:function(a,b){u(a,b)}}}(),w={};q.Bind("item.new",function(a,b){w[a]=I(a,b)});q.Bind("item.rename",
function(a,b){w[a].Rename(b)});q.Bind("item.remove",function(a,b){w[a].Remove();delete w[a]});for(var C=b.Panels,y=0;y<C.length;y++){var D=C[y];q.New(D.Id,D.Name)}};
